@page "/user-management"
@using MauiBlazorWeb.Shared.Components
@using MauiBlazorWeb.Shared.Models.DTOs
@using MauiBlazorWeb.Shared.Services
@using MauiBlazorWeb.Web.Data
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> UserManager
@inject IRoleService RoleService
@attribute [Authorize(Roles = "Admin")]

<PageTitle>User Role Management</PageTitle>

<h1>User Role Management</h1>

<UserRoleManagement
    Users="@Users"
    SelectedUser="@SelectedUser"
    OnUserSelected="HandleUserSelected"/>

@code {
    private List<UserDto> Users { get; set; } = new();
    private UserDto? SelectedUser { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await LoadUsersAsync();
    }

    private async Task LoadUsersAsync()
    {
        Users = await RoleService.GetAllUsersAsync();
    }

    private void HandleUserSelected(UserDto user)
    {
        SelectedUser = user;
    }

}